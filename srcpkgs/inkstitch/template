# Template file for 'inkstitch'
pkgname=inkstitch
version=3.0.1+20231130
revision=1
_commit=d1f46e4eace9858af4ffdc311db549733613fcca
hostmakedepends="python3 git pkg-config wxPython python3-networkx python3-Flask
 python-backports.functools_lru_cache fonttools python3-appdirs python3-Jinja2
 python3-requests python3-diskcache python3-Flask-Cors gobject-introspection
 python3-tinycss2 python3-shapely python3-colormath python3-pyembroidery
 python3-trimesh"
makedepends="python3-devel cairo-devel"
depends="electron24 python3-colormath python3-pyembroidery python3-lxml
 python3-numpy python3-scipy python3-shapely python3-trimesh python3-tinycss2
 python-backports.functools_lru_cache python3-networkx python3-appdirs
 python3-Jinja2 python3-requests python3-Flask fonttools python3-diskcache
 python3-Flask-Cors"
short_desc="Open-source machine embroidery design platform based on Inkscape"
maintainer="wmlhwl <7q0dkmw6@anonaddy.me>"
license="GPL-3.0-or-later"
homepage="https://inkstitch.org/"
distfiles="https://github.com/inkstitch/inkstitch/archive/${_commit}.tar.gz"
checksum=fda4d2310f30380c28747e290cefe25bb9f994989523facdfc3057b6874a4a9a
python_version=3

do_build() {
	python3 -m venv --system-site-packages python-venv
	source python-venv/bin/activate
	pip install git+https://gitlab.com/inkscape/extensions.git@29205f3cc6c39283e190a36d72d01ef42
	make inx
	rm -r python-venv
}

do_install() {
	vmkdir usr/share/inkscape/extensions/
	vcopy "${wrksrc}" /usr/share/inkscape/extensions/inkstitch
}
